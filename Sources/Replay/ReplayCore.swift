// Swift 5.3 will support Package resources like a JS file
// https://github.com/apple/swift-evolution/blob/master/proposals/0271-package-manager-resources.md
// Until then, we'll just copy replay-core.js as a string here

let replayCoreJsString = """
var replay=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";function n(t,e,r){const n=e||game.Game(game.gameProps),p=t.getGetDevice(),a=p(n.props.position),u=o(n,p,0),c=r||n.props.size,d=s(a.size,c);return{initTextures:i(u,n.props,p,!0,d,0),getNextFrameTextures(e){const r=t.getGetDevice(),o=s(r(n.props.position).size,c);return i(u,n.props,r,!1,o,e)}}}function i(t,e,r,n,s,c){const d=a(e.position),l=t.getSprites(e,r,d,n,s,c),f=[],h=l.filter(p).map(e=>{const n={...e,props:{...e.props,position:u(d,e.props.position)}};if("custom"===n.type){f.push(n.props.id);let e=!1;return t.childContainers[n.props.id]||(e=!0,t.childContainers[n.props.id]=o(n,r,t.prevTime)),i(t.childContainers[n.props.id],n.props,r,e,s,c)}return[n]});return Object.keys(t.childContainers).forEach(e=>{f.includes(e)||delete t.childContainers[e]}),h.reduce((t,e)=>t.concat(e),[])}r.r(e),r.d(e,"replayCore",(function(){return n}));function o(t,e,r){const{spriteObj:n,props:i}=t,o=e(i.position),s=[],p=t=>{s.push(t)};let a;return n.init&&(a=n.init({props:i,device:o,updateState:p})),{state:a,childContainers:{},prevTime:r,currentLag:0,getSprites(t,e,r,i,o,a){const u=a-this.prevTime;this.prevTime=a,this.currentLag+=u;const c=e(r);let d=0;if(this.state=s.reduce((t,e)=>e(t),this.state),s.length=0,!i&&n.loop){for(;this.currentLag>=1/60*1e3;)this.state=n.loop({props:t,state:this.state,device:c,updateState:p}),this.currentLag-=1/60*1e3;d=this.currentLag/(1/60*1e3)}let l=n[o];l||(l="renderPXL"===o&&n.renderXL?n.renderXL:n.render);const f=l({props:t,state:this.state,device:c,updateState:p,extrapolateFactor:d});return this.state=s.reduce((t,e)=>e(t),this.state),s.length=0,f}}}function s(t,e){const r=t.deviceHeight>t.deviceWidth;let n,i=!1;return"portrait"in e?(n=r?e.portrait:e.landscape,i=!0):n=e,n.minHeightXL&&t.deviceHeight>=n.minHeightXL||n.minWidthXL&&t.deviceWidth>=n.minWidthXL?i&&r?"renderPXL":"renderXL":i&&r?"renderP":"render"}function p(t){return null!==t}function a(t){return t?{...t,rotation:t.rotation||0}:{x:0,y:0,rotation:0}}function u(t,e){if(!e)return t;const{x:r,y:n,rotation:i}=a(e),o=Math.PI/180,s=-t.rotation*o;return{x:Math.round(t.x+r*Math.cos(s)-n*Math.sin(s))||0,y:Math.round(t.y+r*Math.sin(s)+n*Math.cos(s))||0,rotation:t.rotation+i}}}]);
"""
