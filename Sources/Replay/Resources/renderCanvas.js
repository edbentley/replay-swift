var renderCanvas;renderCanvas=(()=>{"use strict";var e={95:(e,t,n)=>{function i(e,t,n,i){return t.map((t=>{if(n[t]){n[t].globalSpriteIds.push(e);const{data:i}=n[t];return"then"in i?i:Promise.resolve()}const r=i(t).then((e=>{n[t].data=e}));return n[t]={globalSpriteIds:[e],data:r},r}))}function r(e,t,n){for(const i in t){const{globalSpriteIds:r}=t[i],o=r.indexOf(e);-1!==o&&(1===r.length?(n(i),delete t[i]):t[i].globalSpriteIds.splice(o,1))}}function o(e){var t,n,i;return{x:e.x||0,y:e.y||0,rotation:e.rotation||0,opacity:Math.min(1,Math.max(0,null!==(t=e.opacity)&&void 0!==t?t:1)),scaleX:null!==(n=e.scaleX)&&void 0!==n?n:1,scaleY:null!==(i=e.scaleY)&&void 0!==i?i:1,anchorX:e.anchorX||0,anchorY:e.anchorY||0,mask:e.mask||null}}function a(e,t){var n,i,r;e.x=t.x||0,e.y=t.y||0,e.rotation=t.rotation||0,e.opacity=Math.min(1,Math.max(0,null!==(n=t.opacity)&&void 0!==n?n:1)),e.scaleX=null!==(i=t.scaleX)&&void 0!==i?i:1,e.scaleY=null!==(r=t.scaleY)&&void 0!==r?r:1,e.anchorX=t.anchorX||0,e.anchorY=t.anchorY||0,e.mask=t.mask||null}function s(e,t,n,i,o,s,d,c,p,h,u,m){const{baseProps:g}=e;a(g,t);const f=e=>{const t=o(e);return function(e){const t=Math.PI/180,n=-(e.rotation||0)*t;return({x:t,y:i})=>{const r=t-e.x,o=i-e.y,a=r*Math.cos(n)+o*Math.sin(n),s=-r*Math.sin(n)+o*Math.cos(n),l=a/e.scaleX,d=s/e.scaleY;return{x:l+e.anchorX,y:d+e.anchorY}}}(g)(t)};let w=null;const v=()=>(w||(w=i(f)),w),y=e.getSprites(t,v,s,d,c,m),S=e.prevChildIdsSet,b=e.prevChildIds;let P=0;if(u.startRenderSprite(g),l(y,e,n,i,d,c,p,h,u,m,(e=>{b[P]=e,P++,S.delete(e)}),v,f),u.endRenderSprite(),h.nativeSpriteUtils.didResize=!1,P<b.length&&(b.length=P),S.forEach((t=>{const i=(e,t)=>{Object.entries(e).forEach((([e,o])=>{if("custom"===o.type){const a=`${t}--${e}`;i(o.childContainers,a),o.cleanup(v),o.loadFilesPromise&&o.loadFilesPromise.then((()=>{var e,t;r(e=a,(t=n.assetUtils).audioElements,t.cleanupAudioFile),r(e,t.imageElements,t.cleanupImageFile)}))}else"native"===o.type&&o.cleanup({state:o.state,parentGlobalId:p})}))},o=e.childContainers[t];i({[t]:o},p),delete e.childContainers[t]})),e.prevChildIdsSet=new Set(b),e.prevChildIdsSet.size<b.length){const e=b.find(((e,t)=>b.indexOf(e)!==t));throw Error(`Duplicate Sprite id ${e}`)}}function l(e,t,n,i,r,o,a,d,p,m,g,f,w){for(let v=0;v<e.length;v++){const y=e[v];if(y)if("context"===y.type)l(y.sprites,t,n,i,r,o,a,d,p,[...m,y],g,f,w);else if("native"===y.type){g(y.props.id);const{nativeSpriteMap:e,nativeSpriteUtils:n}=d,i=e[y.name];if(!i)throw Error(`Cannot find Native Sprite "${y.name}"`);let r=t.childContainers[y.props.id];if(!r||"native"!==r.type){const e={type:"native",state:i.create({props:y.props,parentGlobalId:a,getState:()=>e.state,updateState:t=>{e.state={...e.state,...t}},utils:n}),cleanup:i.cleanup};t.childContainers[y.props.id]=e,r=e}r.state=i.loop({props:y.props,state:r.state,parentGlobalId:a,utils:n})}else if("pure"===y.type){g(y.props.id);let e=t.childContainers[y.props.id];e&&"pure"===e.type||(e=h(y),t.childContainers[y.props.id]=e),u(e,y.props,n.size,d.nativeSpriteUtils.didResize,r,p)}else if("custom"===y.type){g(y.props.id);let e=!1,l=t.childContainers[y.props.id];const h=`${a}--${y.props.id}`;l&&"custom"===l.type||(e=!0,l=c(y,n,f,t.prevTime,h,m),t.childContainers[y.props.id]=l),s(l,y.props,n,i,w,e,r,o,h,d,p,m)}else p.renderTexture(y)}}n.r(t),n.d(t,{run:()=>Y});const d=1/60*1e3;function c(e,t,n,r,a,s){const{spriteObj:l,props:d}=e,c=[],p=e=>{c.push(e)};let h,u=null,m=null;l.init&&(h=l.init({props:d,getState:()=>{if(!u)throw Error("Cannot call getState synchronously in init");return u.state},device:t,getInputs:n,updateState:p,getContext:e=>{const t=s.find((t=>t.context===e));if(!t)throw Error("No context setup");return t.value},preloadFiles:async e=>{const n=async function(e,t,n){await Promise.all([...i(e,t.audioFileNames||[],n.audioElements,n.loadAudioFile),...i(e,t.imageFileNames||[],n.imageElements,n.loadImageFile)])}(a,e,t.assetUtils);u?u.loadFilesPromise=n:m=n,await n}}));const g=()=>{let e=0;for(;e<c.length;){const t=c[e];u.state=t(u.state),e++}c.length=0},f=()=>u.state;return u={type:"custom",state:h,baseProps:o(d),childContainers:{},prevChildIds:[],prevChildIdsSet:new Set,prevTime:r,currentLag:0,loadFilesPromise:m,getSprites(e,n,i,r,o,a){g();const s=e=>{const t=a.find((t=>t.context===e));if(!t)throw Error("No context setup");return t.value};!i&&l.loop&&(this.state=l.loop({props:e,state:this.state,device:t,getInputs:n,updateState:p,getState:f,getContext:s})),g();let d=l[r];d||(d="renderPXL"===r&&l.renderXL?l.renderXL:l.render);const c=d({props:e,state:this.state,device:t,getInputs:n,updateState:p,getState:f,getContext:s,extrapolateFactor:o});return g(),c},cleanup(e){var n;null===(n=l.cleanup)||void 0===n||n.call(l,{state:this.state,device:t,getInputs:e})}},u}function p(e,t){const n=e.deviceHeight>e.deviceWidth;let i,r=!1;return"portrait"in t?(i=n?t.portrait:t.landscape,r=!0):i=t,i.minHeightXL&&e.deviceHeight>=i.minHeightXL||i.minWidthXL&&e.deviceWidth>=i.minWidthXL?r&&n?"renderPXL":"renderXL":r&&n?"renderP":"render"}function h(e){const{spriteObj:t}=e;return{type:"pure",childContainers:{},prevChildIds:[],prevChildIdsSet:new Set,baseProps:o(e.props),getSprites(e,n,i,r){if(this.prevProps&&this.cache&&!t.shouldRerender(this.prevProps,e)&&!i)return this.prevProps=e,this.cache;let o=t[r];return o||(o="renderPXL"===r&&t.renderXL?t.renderXL:t.render),this.prevProps=e,{type:"pureSprites",sprites:o({props:e,size:n})}}}}function u(e,t,n,i,r,o){const{baseProps:s}=e;a(s,t);const l=e.getSprites(t,n,i,r);return"cache"===l.type?(m(l,o),l):function(e,t,n,i,r,o){const{baseProps:a}=e,s=e.prevChildIdsSet,l=e.prevChildIds;let d=0;o.startRenderSprite(a);const c=new Array(t.length);let p=0;for(let a=0;a<t.length;a++){const m=t[a];if(m)if("pure"===m.type){l[d]=m.props.id,d++,s.delete(m.props.id);let t=e.childContainers[m.props.id];t&&"pure"===t.type||(t=h(m),e.childContainers[m.props.id]=t),c[p]=u(t,m.props,n,i,r,o),p++}else o.renderTexture(m),c[p]=m,p++}p<c.length&&(c.length=p),o.endRenderSprite(),s.forEach((t=>{delete e.childContainers[t]}));const m={type:"cache",baseProps:a,items:c};if(e.cache=m,d<l.length&&(l.length=d),e.prevChildIdsSet=new Set(l),e.prevChildIdsSet.size<l.length){const e=l.find(((e,t)=>l.indexOf(e)!==t));throw Error(`Duplicate Sprite id ${e}`)}return m}(e,l.sprites,n,i,r,o)}function m(e,t){t.startRenderSprite(e.baseProps);for(let n=0;n<e.items.length;n++){const i=e.items[n];"cache"===i.type?m(i,t):t.renderTexture(i)}t.endRenderSprite()}let g={keysDown:{},keysJustPressed:{},pointer:{pressed:!1,numberPressed:0,justPressed:!1,justReleased:!1,x:0,y:0}},f=[];function w(e){return function(e,t){const n=e(t.pointer);return{...t,pointer:{...t.pointer,x:n.x,y:n.y}}}(e,g)}function v(e){["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&!(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement)&&e.preventDefault(),g.keysDown[e.key]=!0,g.keysJustPressed[e.key]=!0}function y(e){delete g.keysDown[e.key]}function S(e,t,n){f.includes(n)||(f=[...f,n]),g.pointer.pressed=!0,g.pointer.numberPressed=f.length,g.pointer.justPressed=!0,g.pointer.x=e,g.pointer.y=t}function b(e,t){g.pointer.x=e,g.pointer.y=t}function P(e,t,n){f=f.filter((e=>e!==n)),0===f.length&&(g.pointer.justPressed=!1,g.pointer.pressed=!1),g.pointer.numberPressed=f.length,g.pointer.justReleased=!0,g.pointer.x=e,g.pointer.y=t}function T(e){f=f.filter((t=>t!==e)),g.pointer.numberPressed=f.length,0===f.length&&(g.pointer.justPressed=!1,g.pointer.pressed=!1)}function x(){g={keysDown:g.keysDown,keysJustPressed:{},pointer:{...g.pointer,justPressed:!1,justReleased:!1}}}const E=(e,t)=>{const[[n,i],[r,o]]=t.path,a=e.createLinearGradient(n,i,r,o);return t.colors.forEach((({offset:e,color:t})=>{a.addColorStop(e,t)})),a},M=(e,t)=>{const n=e[t];if(!n)throw Error(`Image file "${t}" was not preloaded`);if("then"in n.data)throw Error(`Image file "${t}" did not finish loading before it was used`);return n.data},k=Math.PI/180,C=(e,t,n)=>{const{x:i,y:r,rotation:o,scaleX:a,scaleY:s,anchorX:l,anchorY:d,opacity:c}=t;0===i&&0===r||e.translate(i,-r),0!==o&&e.rotate(o*k),1===a&&1===s||e.scale(a,s),0===l&&0===d||e.translate(-l,d),1!==c&&(e.globalAlpha=n),function(e,t){if(!t)return 0;switch(t.type){case"lineMask":{const[[n,i],...r]=t.path;return e.beginPath(),e.moveTo(n,-i),r.forEach((([t,n])=>{e.lineTo(t,-n)})),e.clip(),0}case"circleMask":return e.beginPath(),e.arc(t.x,-t.y,Math.round(t.radius),0,2*Math.PI),e.clip(),0;case"rectangleMask":e.beginPath(),e.rect(t.x-t.width/2,-t.y-t.height/2,t.width,t.height),e.clip()}}(e,t.mask)},I=e=>({globalAlphaStack:[1],circle(t,n,i){e.beginPath(),e.arc(0,0,Math.round(t),0,2*Math.PI),e.fillStyle=i?E(e,i):n,e.fill(),e.closePath()},rectangle(t,n,i,r){e.fillStyle=r?E(e,r):i,e.fillRect(-t/2,-n/2,t,n),e.closePath()},line(t,n,i,r,o,a,s){if(t.length<2)return;const[[l,d],...c]=t;e.beginPath(),e.moveTo(l,-d),c.forEach((([t,n])=>{e.lineTo(t,-n)})),a?(e.fillStyle=E(e,a),e.fill()):r&&(e.fillStyle=r,e.fill()),o?(e.strokeStyle=E(e,o),e.lineWidth=n,e.lineCap=s,e.stroke()):i&&(e.strokeStyle=i,e.lineWidth=n,e.lineCap=s,e.stroke())},text(t,n,i,r,o,a=1){const{size:s,weight:l="normal",style:d="normal",family:c}=t,p=`${d} ${l} ${s?`${s}px`:""} ${c?`${c}`:""}`;e.font=p,e.textBaseline=t.baseline||"middle",e.textAlign=t.align||"center",o&&(e.strokeStyle=o,e.lineWidth=a,e.strokeText(n,0,0)),e.fillStyle=r?E(e,r):i,e.fillText(n,0,0)},image(t,n,i){e.drawImage(t,-n/2,-i/2,n,i)},spriteSheet(t,n,i,r,o,a){const s=t.width/n,l=t.height/i,d=r%n,c=Math.floor(r/n)%i;e.drawImage(t,d*s,c*l,s,l,-o/2,-a/2,o,a)}});function R(e,t,n,i){let r;r="portrait"in i?t>e?i.portrait:i.landscape:i;const{width:o,height:a,maxWidthMargin:s=0,maxHeightMargin:l=0}=r;if("game-coords"===n||0===e||0===t)return{width:o,height:a,widthMargin:0,heightMargin:0,deviceWidth:o,deviceHeight:a};const d=o/a;if(d>e/t){const n=e,i=n/d,r=i/a*l,s=Math.min(t,i+2*r);return{width:o,height:a,widthMargin:0,heightMargin:(s-i)/2*(a/i),deviceWidth:n,deviceHeight:s}}{const n=t,i=n*d,r=i/o*s,l=Math.min(e,i+2*r);return{width:o,height:a,widthMargin:(l-i)/2*(o/i),heightMargin:0,deviceWidth:l,deviceHeight:n}}}function _(){const e={};return{start:(t,n)=>{const i=window.setTimeout((()=>{delete e[r],t()}),n),r=String(i);return e[r]={timeoutId:i,callback:t,timeStartedMs:Date.now(),timeRemainingMs:n,isPaused:!1},r},pause:t=>{const n=e[t];if(!n||n.isPaused)return;const i=Date.now()-n.timeStartedMs;n.timeRemainingMs-=i,n.isPaused=!0,window.clearTimeout(n.timeoutId)},resume:t=>{const n=e[t];if(!n||!n.isPaused)return;n.timeStartedMs=Date.now(),n.isPaused=!1;const i=window.setTimeout((()=>{delete e[t],n.callback()}),n.timeRemainingMs);n.timeoutId=i},cancel:t=>{const n=e[t];n&&(window.clearTimeout(n.timeoutId),delete e[t])}}}function L(e,t){return n=>{if(!t[n])throw Error(`Audio file "${n}" was not preloaded`);const{data:i}=t[n];if("then"in i)throw Error(`Audio file "${n}" did not finish loading before it was used`);const{buffer:r,playState:o}=i;return{getPosition:()=>z(e,i.playState),play:a=>{let s,l=!1,d=!1,c=1;"number"==typeof a?s=a:a&&({fromPosition:s,loop:l=l,overwrite:d=d,playbackRate:c=c}=a);const p=e.createBufferSource();p.buffer=r,p.playbackRate.value=c;const h=e.createGain();p.connect(h),h.connect(e.destination);const u=null!=s?s:z(e,o);try{p.start(void 0,u)}catch(e){return}p.loop=l,p.onended=()=>{var e;if(!t[n])return;const{data:i}=t[n];"then"in i||!1!==(null===(e=i.playState)||void 0===e?void 0:e.isPaused)||delete i.playState};const m=o&&!o.isPaused;m&&!d||(o&&m&&(o.sample.onended=null,o.sample.stop()),i.playState={playTime:e.currentTime,sample:p,alreadyPlayedTime:u,isPaused:!1,gainNode:h})},pause:()=>{o&&!o.isPaused&&(o.sample.onended=null,o.sample.stop(),i.playState={...o,alreadyPlayedTime:z(e,o),isPaused:!0})},getStatus:()=>i.playState&&!1===i.playState.isPaused?"playing":"paused",getDuration:()=>r.duration,getVolume:()=>i.playState?i.playState.gainNode.gain.value:1,setVolume:t=>{const n=i.playState;if(n)if("number"==typeof t)n.gainNode.gain.setValueAtTime(Math.max(Math.min(1,t),0),e.currentTime);else{const{type:i,fadeTo:r,fadeTime:o}=t,a=Math.max(Math.min(1,r),0);"linear"===i?n.gainNode.gain.linearRampToValueAtTime(a,e.currentTime+o):n.gainNode.gain.exponentialRampToValueAtTime(a,e.currentTime+o)}}}}}function z(e,t){return t?t.isPaused?t.alreadyPlayedTime:(e.currentTime-t.playTime)*t.sample.playbackRate.value+t.alreadyPlayedTime:0}const X={family:"sans-serif",size:12};function $(e,t,n){const{dimensions:i="game-coords",canvas:r,nativeSpriteMap:o={},windowSize:a,statsBegin:l,statsEnd:h}=t||{},u=r||document.createElement("canvas");r||document.body.appendChild(u);const m=window.PointerEvent?"pointerdown":"touchstart",g=window.PointerEvent?"pointermove":"touchmove",f=window.PointerEvent?"pointerup":"touchend",E=window.PointerEvent?"pointercancel":"touchcancel",k=u.getContext("2d",{alpha:!1}),z=new(window.AudioContext||window.webkitAudioContext);let $=!0,A=!0,F=0,Y=!1,O=0,j=0;const D=()=>{document.hidden&&A&&(O=F,z.suspend()),document.hidden||A||(Y=!0,setTimeout((()=>{z.suspend(),setTimeout((()=>{z.resume()}),75)}),75)),A=!document.hidden};document.addEventListener("keydown",(e=>{$&&!e.repeat&&v(e)}),!1),document.addEventListener("keyup",(e=>{$&&y(e)}),!1),document.addEventListener("visibilitychange",D,!1),window.addEventListener("resize",q,!1);const H=()=>q({didScroll:!0});let N,W,G,U,B,J;window.addEventListener("scroll",H,!1),document.addEventListener("contextmenu",(e=>{e.preventDefault()}));const V={didResize:!1,scale:1,gameXToPlatformX:e=>e,gameYToPlatformY:e=>e};function q(t){const n=Boolean(t&&"cleanup"in t&&t.cleanup),r=Boolean(t&&"didScroll"in t&&t.didScroll);if(N&&(k.restore(),document.removeEventListener(m,W),document.removeEventListener(g,G),document.removeEventListener(f,U),document.removeEventListener(E,B),n))return;r&&N||(ie.size=R((null==a?void 0:a.width)||window.innerWidth,(null==a?void 0:a.height)||window.innerHeight,i,e.props.size));const o=window.devicePixelRatio||1;u.width=ie.size.deviceWidth*o,u.height=ie.size.deviceHeight*o,u.style.width=`${ie.size.deviceWidth}px`,u.style.height=`${ie.size.deviceHeight}px`;const s=e.props.defaultFont||X,l=e.props.backgroundColor||"white",d=function(e,{width:t,height:n,widthMargin:i,heightMargin:r,deviceWidth:o,deviceHeight:a},s,l,d,c){e.save();const p=o*s,h=a*s,u=t+2*i,m=n+2*r;e.translate(p/2,h/2);const g=p/u;e.scale(g,g);const f=I(e);return{scale:o/u,render:{newFrame:()=>{e.clearRect(-u/2,-m/2,u,m),e.fillStyle=c,e.fillRect(-u/2,-m/2,u,m)},startRenderSprite:t=>{e.save();const n=t.opacity*f.globalAlphaStack[0];C(e,t,n),f.globalAlphaStack.unshift(n)},endRenderSprite:()=>{e.restore(),f.globalAlphaStack.shift()},renderTexture:t=>{e.save();const n=t.props.opacity*f.globalAlphaStack[0];C(e,t.props,n),function(e,t,n,i){switch(e.type){case"text":const r={...i,...e.props.font};return t.text(r,e.props.text,e.props.color,e.props.gradient,e.props.strokeColor,e.props.strokeThickness),0;case"circle":return t.circle(e.props.radius,e.props.color,e.props.gradient),0;case"rectangle":return t.rectangle(e.props.width,e.props.height,e.props.color,e.props.gradient),0;case"line":return t.line(e.props.path,e.props.thickness,e.props.color,e.props.fillColor,e.props.gradient,e.props.fillGradient,e.props.lineCap),0;case"image":return t.image(M(n,e.props.fileName),e.props.width,e.props.height),0;case"spriteSheet":t.spriteSheet(M(n,e.props.fileName),e.props.columns,e.props.rows,e.props.index,e.props.width,e.props.height)}}(t,f,l,d),e.restore()}}}}(k,ie.size,o,Q,s,l);J=d.scale,ne.newFrame=d.render.newFrame,ne.startRenderSprite=d.render.startRenderSprite,ne.endRenderSprite=d.render.endRenderSprite,ne.renderTexture=d.render.renderTexture,V.gameXToPlatformX=(({canvasOffsetLeft:e,widthMargin:t,scale:n,width:i})=>r=>e+n*(r+i/2+t))({canvasOffsetLeft:u.offsetLeft,width:ie.size.width,widthMargin:ie.size.widthMargin,scale:J}),V.gameYToPlatformY=(({canvasOffsetTop:e,heightMargin:t,scale:n,height:i})=>r=>e-n*(r-i/2-t))({canvasOffsetTop:u.offsetTop,height:ie.size.height,heightMargin:ie.size.heightMargin,scale:J}),V.didResize=!0,V.scale=J;const c=(({canvasOffsetLeft:e,scrollX:t,widthMargin:n,scale:i,width:r})=>o=>(o.clientX-e+t)/i-n-r/2)({canvasOffsetLeft:u.offsetLeft,scrollX:window.scrollX,width:ie.size.width,widthMargin:ie.size.widthMargin,scale:J}),p=(({canvasOffsetTop:e,scrollY:t,heightMargin:n,scale:i,height:r})=>o=>-(o.clientY-e+t)/i+n+r/2)({canvasOffsetTop:u.offsetTop,scrollY:window.scrollY,height:ie.size.height,heightMargin:ie.size.heightMargin,scale:J}),h=(e,t)=>e>ie.size.width/2+ie.size.widthMargin||e<-ie.size.width/2-ie.size.widthMargin||t>ie.size.height/2+ie.size.heightMargin||t<-ie.size.height/2-ie.size.heightMargin;W=e=>{if("changedTouches"in e){$=!1;for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches[t],i=c({clientX:n.screenX}),r=p({clientY:n.screenY});h(i,r)||($=!0,S(i,r,n.identifier))}return}const t=c(e),n=p(e);h(t,n)?$=!1:($=!0,S(t,n,e.pointerId))},G=e=>{if("changedTouches"in e){for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches[t],i=c({clientX:n.screenX}),r=p({clientY:n.screenY});h(i,r)||b(i,r)}return}const t=c(e),n=p(e);h(t,n)||b(t,n)},U=e=>{if("changedTouches"in e){for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches[t],i=c({clientX:n.screenX}),r=p({clientY:n.screenY});h(i,r)?T(n.identifier):P(i,r,n.identifier)}return}const t=c(e),n=p(e);h(t,n)?T(e.pointerId):P(t,n,e.pointerId)},B=e=>{if("changedTouches"in e)for(let t=0;t<e.changedTouches.length;t++)T(e.changedTouches[t].identifier);else T(e.pointerId)},document.addEventListener(m,W,!1),document.addEventListener(g,G,!1),document.addEventListener(f,U,!1),document.addEventListener(E,B,!1),N=ie.size}const K={},Q={},Z=(e,t)=>()=>{throw Error(`Failed to load ${e} file "${t}"`)},ee=(null==n?void 0:n.fileFetch)||fetch,te={audioElements:K,imageElements:Q,loadAudioFile:e=>async function(e,t){const n=await t,i=await n.arrayBuffer();return await new Promise(((t,n)=>{e.decodeAudioData(i,t,n)}))}(z,ee(e)).then((e=>({buffer:e,volume:1}))).catch(Z("audio",e)),loadImageFile:e=>new Promise(((t,n)=>{const i=new Image;i.addEventListener("load",(()=>{t(i)})),i.addEventListener("error",n),i.src=e})).catch(Z("image",e)),cleanupAudioFile:e=>{const{data:t}=K[e];!("then"in t)&&t.playState&&(t.playState.sample.onended=null,t.playState.sample.disconnect(),t.playState.sample.buffer=null)},cleanupImageFile:()=>null},ne={newFrame:()=>null,startRenderSprite:()=>null,endRenderSprite:()=>null,renderTexture:()=>null},ie=function(e,t,n,i){return{isTouchScreen:!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)||window.matchMedia("(touch-enabled),(-webkit-touch-enabled),(-moz-touch-enabled),(-o-touch-enabled),(-ms-touch-enabled)").matches,log:console.log,random:Math.random,timer:_(),audio:L(e,n.audioElements),assetUtils:n,network:{get:(e,t)=>{fetch(e).then((e=>e.json())).then(t)},post:(e,t,n)=>{fetch(e,{method:"POST",body:JSON.stringify(t)}).then((e=>e.json())).then(n)},put:(e,t,n)=>{fetch(e,{method:"PUT",body:JSON.stringify(t)}).then((e=>e.json())).then(n)},delete:(e,t)=>{fetch(e,{method:"DELETE"}).then((e=>e.json())).then(t)}},storage:{getItem:async e=>localStorage.getItem(e),setItem:async(e,t)=>{null!==t?localStorage.setItem(e,t):localStorage.removeItem(e)}},alert:{ok:(e,t)=>{alert(e),null==t||t()},okCancel:(e,t)=>{t(confirm(e))}},clipboard:{copy:(e,t)=>{navigator.clipboard?navigator.clipboard.writeText(e).then((()=>{t()})).catch((e=>{t(e)})):t(new Error(window.isSecureContext?"Couldn't access clipboard":"Clipboard only available on HTTPS or localhost"))}},size:t,now:()=>new Date,...i}}(z,R((null==a?void 0:a.width)||window.innerWidth,(null==a?void 0:a.height)||window.innerHeight,i,e.props.size),te,(null==n?void 0:n.device)||{}),re={mutDevice:ie,getInputs:w,render:ne};let oe=!1;const ae=()=>{document.removeEventListener("keydown",ae,!1),document.removeEventListener(m,ae,!1),"suspended"===z.state&&z.resume(),z.onstatechange=()=>{"suspended"!==z.state||document.hidden||z.resume()}};return document.addEventListener("keydown",ae,!1),document.addEventListener(m,ae,!1),function t(){const n=(null==a?void 0:a.width)||window.innerWidth,i=(null==a?void 0:a.height)||window.innerHeight;if(!n||!i)return void setTimeout(t,50);q();const{runNextFrame:r}=function(e,t,n,i){const r=({x:e,y:t})=>({x:e,y:t}),{mutDevice:o,getInputs:a}=e,l=c(n,o,(()=>a(r)),0,n.props.id,[]),h=n.props.size,u=p(o.size,h);let m=0,g=0;e.render.newFrame(),s(l,n.props,o,a,r,!0,u,0,n.props.id,t,e.render,[]);const f={newFrame:()=>null,startRenderSprite:()=>null,endRenderSprite:()=>null,renderTexture:()=>null};return{runNextFrame(i,c){const u=i-m;m=i,g+=u;let w=Math.floor(g/d);for(;w>0;){g-=d,w--;const i=g/d,u=p(o.size,h),m=0===w?e.render:f;m.newFrame(),s(l,n.props,o,a,r,!1,u,i,n.props.id,t,m,[]),c()}}}}(re,{nativeSpriteMap:o,nativeSpriteUtils:V},e);let u=null;!function e(){null==h||h(),window.requestAnimationFrame((function(t){oe||(null==l||l(),null===u&&(u=t-1/60),A?(Y&&(Y=!1,j+=t-O),F=t,r(t-u-j,x),e()):e())}))}()}(),{cleanup:function(){u.width=u.width,r||document.body.removeChild(u),oe=!0,document.removeEventListener("keydown",v,!1),document.removeEventListener("keyup",y,!1),document.removeEventListener("visibilitychange",D,!1),window.removeEventListener("resize",q,!1),window.removeEventListener("scroll",H,!1),q({cleanup:!0})},audioElements:K,imageElements:Q,audioContext:z}}function A({id:e,message:t}){return new Promise((n=>{new Promise((t=>{let n=window.__replayGlobalCallbacks__;n||(n={},window.__replayGlobalCallbacks__=n),n[e]=e=>{t(e)}})).then((t=>{window.__replayGlobalCallbacks__[e]=void 0,n(t)})),window.webkit.messageHandlers.jsCallback.postMessage(t)}))}const F=(...e)=>{window.webkit.messageHandlers.consoleLog.postMessage(e.map((e=>"string"==typeof e?e:e instanceof Error?`Error(${e.message})`:JSON.stringify(e))).join("    "))};function Y(){$(game.Game(game.gameProps),game.options,{device:{storage:{getItem:async e=>{const t=await A({id:`__internalReplayStorageGetItem-${e}`,message:`__internalReplayStorageGetItem-${e}`});if("error"in t)throw Error(t.error);return t.value},setItem:async(e,t)=>{if(null===t){const t=await A({id:`__internalReplayStorageRemoveItem-${e}`,message:`__internalReplayStorageRemoveItem-${e}`});if("string"==typeof t)throw Error(t);return}const n=await A({id:`__internalReplayStorageSetItem-${e}`,message:`__internalReplayStorageSetItem-${e}_____end_of_key______${t}`});if("string"==typeof n)throw Error(n)}},clipboard:{copy(e,t){A({id:"__internalReplayClipboardCopy",message:`__internalReplayClipboardCopy${e}`}).then((()=>{t()}))}},alert:{ok:(e,t)=>{A({id:"__internalReplayAlertOk",message:`__internalReplayAlertOk${e}`}).then((()=>{null==t||t()}))},okCancel:(e,t)=>{A({id:"__internalReplayAlertConfirm",message:`__internalReplayAlertConfirm${e}`}).then((e=>{t(e)}))}}}})}console.log=F,console.info=F,console.warn=F,console.error=F}},t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}return n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(95)})();