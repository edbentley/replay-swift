var renderCanvas;renderCanvas=(()=>{"use strict";var e={95:(e,t,n)=>{function i(e,t,n,i){return t.map((t=>{if(n[t]){n[t].globalSpriteIds.add(e);const{data:i}=n[t];return"then"in i?i:Promise.resolve()}const r=i(t).then((e=>{n[t].data=e}));return n[t]={globalSpriteIds:new Set([e]),data:r},r}))}function r(e,t,n){for(const i in t){const{globalSpriteIds:r}=t[i];r.has(e)&&(1===r.size?(n(i),delete t[i]):t[i].globalSpriteIds.delete(e))}}function o(e){var t,n,i;return{x:e.x||0,y:e.y||0,rotation:e.rotation||0,opacity:Math.min(1,Math.max(0,null!==(t=e.opacity)&&void 0!==t?t:1)),scaleX:null!==(n=e.scaleX)&&void 0!==n?n:1,scaleY:null!==(i=e.scaleY)&&void 0!==i?i:1,anchorX:e.anchorX||0,anchorY:e.anchorY||0,mask:e.mask||null}}function a(e,t){var n,i,r;e.x=t.x||0,e.y=t.y||0,e.rotation=t.rotation||0,e.opacity=Math.min(1,Math.max(0,null!==(n=t.opacity)&&void 0!==n?n:1)),e.scaleX=null!==(i=t.scaleX)&&void 0!==i?i:1,e.scaleY=null!==(r=t.scaleY)&&void 0!==r?r:1,e.anchorX=t.anchorX||0,e.anchorY=t.anchorY||0,e.mask=t.mask||null}function s(e,t,n,i,o,l,c,u,m,g,f){const{baseProps:w}=e;a(w,t);const{nativeSpriteMap:v,nativeSpriteUtils:y}=g,S=e=>{const t=o(e);return function(e){const t=Math.PI/180,n=-(e.rotation||0)*t;return({x:t,y:i})=>{const r=t-e.x,o=i-e.y,a=r*Math.cos(n)+o*Math.sin(n),s=-r*Math.sin(n)+o*Math.cos(n),l=a/e.scaleX,d=s/e.scaleY;return{x:l+e.anchorX,y:d+e.anchorY}}}(w)(t)};let b=null;const P=()=>(b||(b=i(S)),b),M=e.getSprites(t,P,l,c,u),T=new Set(e.prevChildIds);if(T.size<e.prevChildIds.length){const t=e.prevChildIds.find(((t,n)=>e.prevChildIds.indexOf(t)!==n));throw Error(`Duplicate Sprite id ${t}`)}const E=e.prevChildIds;let I=0;f.startRenderSprite(w);for(let t=0;t<M.length;t++){const r=M[t];if(r)if("native"===r.type){E[I]=r.props.id,I++,T.delete(r.props.id);const t=v[r.name];if(!t)throw Error(`Cannot find Native Sprite "${r.name}"`);let n=e.childContainers[r.props.id];if(!n||"native"!==n.type){const i={type:"native",state:t.create({props:r.props,parentGlobalId:m,getState:()=>i.state,updateState:e=>{i.state={...i.state,...e}},utils:y}),cleanup:t.cleanup};e.childContainers[r.props.id]=i,n=i}n.state=t.loop({props:r.props,state:n.state,parentGlobalId:m,utils:y})}else if("pure"===r.type){E[I]=r.props.id,I++,T.delete(r.props.id);let t=e.childContainers[r.props.id];t&&"pure"===t.type||(t=p(r),e.childContainers[r.props.id]=t),h(t,r.props,n.size,y.didResize,c,f)}else if("custom"===r.type){E[I]=r.props.id,I++,T.delete(r.props.id);let t=!1,o=e.childContainers[r.props.id];const a=`${m}--${r.props.id}`;o&&"custom"===o.type||(t=!0,o=d(r,n,P,e.prevTime,a),e.childContainers[r.props.id]=o),s(o,r.props,n,i,S,t,c,u,a,g,f)}else f.renderTexture(r)}f.endRenderSprite(),y.didResize=!1,I<E.length&&(E.length=I),T.forEach((t=>{const i=(e,t)=>{Object.entries(e).forEach((([e,o])=>{if("custom"===o.type){const a=`${t}--${e}`;i(o.childContainers,a),o.loadFilesPromise&&o.loadFilesPromise.then((()=>{var e,t;r(e=a,(t=n.assetUtils).audioElements,t.cleanupAudioFile),r(e,t.imageElements,t.cleanupImageFile)}))}else"native"===o.type&&o.cleanup({state:o.state,parentGlobalId:m})}))},o=e.childContainers[t];i({[t]:o},m),delete e.childContainers[t]}))}n.r(t),n.d(t,{run:()=>F});const l=1/60*1e3;function d(e,t,n,r,a){const{spriteObj:s,props:l}=e,d=[],c=e=>{d.push(e)};let p,h=null,u=null;s.init&&(p=s.init({props:l,getState:()=>{if(!h)throw Error("Cannot call getState synchronously in init");return h.state},device:t,getInputs:n,updateState:c,preloadFiles:async e=>{const n=async function(e,t,n){await Promise.all([...i(e,t.audioFileNames||[],n.audioElements,n.loadAudioFile),...i(e,t.imageFileNames||[],n.imageElements,n.loadImageFile)])}(a,e,t.assetUtils);h?h.loadFilesPromise=n:u=n,await n}}));const m=()=>{let e=0;for(;e<d.length;){const t=d[e];h.state=t(h.state),e++}d.length=0},g=()=>h.state;return h={type:"custom",state:p,baseProps:o(l),childContainers:{},prevChildIds:[],prevTime:r,currentLag:0,loadFilesPromise:u,getSprites(e,n,i,r,o){m(),!i&&s.loop&&(this.state=s.loop({props:e,state:this.state,device:t,getInputs:n,updateState:c,getState:g})),m();let a=s[r];a||(a="renderPXL"===r&&s.renderXL?s.renderXL:s.render);const l=a({props:e,state:this.state,device:t,getInputs:n,updateState:c,getState:g,extrapolateFactor:o});return m(),l}},h}function c(e,t){const n=e.deviceHeight>e.deviceWidth;let i,r=!1;return"portrait"in t?(i=n?t.portrait:t.landscape,r=!0):i=t,i.minHeightXL&&e.deviceHeight>=i.minHeightXL||i.minWidthXL&&e.deviceWidth>=i.minWidthXL?r&&n?"renderPXL":"renderXL":r&&n?"renderP":"render"}function p(e){const{spriteObj:t}=e;return{type:"pure",childContainers:{},prevChildIds:[],baseProps:o(e.props),getSprites(e,n,i,r){if(this.prevProps&&this.cache&&!t.shouldRerender(this.prevProps,e)&&!i)return this.prevProps=e,this.cache;let o=t[r];return o||(o="renderPXL"===r&&t.renderXL?t.renderXL:t.render),this.prevProps=e,{type:"pureSprites",sprites:o({props:e,size:n})}}}}function h(e,t,n,i,r,o){const{baseProps:s}=e;a(s,t);const l=e.getSprites(t,n,i,r);return"cache"===l.type?(u(l,o),l):function(e,t,n,i,r,o){const{baseProps:a}=e,s=new Set(e.prevChildIds),l=e.prevChildIds;let d=0;o.startRenderSprite(a);const c=new Array(t.length);let u=0;for(let a=0;a<t.length;a++){const m=t[a];if(m)if("pure"===m.type){l[d]=m.props.id,d++,s.delete(m.props.id);let t=e.childContainers[m.props.id];t&&"pure"===t.type||(t=p(m),e.childContainers[m.props.id]=t),c[u]=h(t,m.props,n,i,r,o),u++}else o.renderTexture(m),c[u]=m,u++}u<c.length&&(c.length=u),o.endRenderSprite(),s.forEach((t=>{delete e.childContainers[t]}));const m={type:"cache",baseProps:a,items:c};return e.cache=m,d<l.length&&(l.length=d),m}(e,l.sprites,n,i,r,o)}function u(e,t){t.startRenderSprite(e.baseProps);for(let n=0;n<e.items.length;n++){const i=e.items[n];"cache"===i.type?u(i,t):t.renderTexture(i)}t.endRenderSprite()}let m={keysDown:{},keysJustPressed:{},pointer:{pressed:!1,numberPressed:0,justPressed:!1,justReleased:!1,x:0,y:0}},g=[];function f(e){return function(e,t){const n=e(t.pointer);return{...t,pointer:{...t.pointer,x:n.x,y:n.y}}}(e,m)}function w(e){["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&!(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement)&&e.preventDefault(),m.keysDown[e.key]=!0,m.keysJustPressed[e.key]=!0}function v(e){delete m.keysDown[e.key]}function y(e,t,n){g.includes(n)||(g=[...g,n]),m.pointer.pressed=!0,m.pointer.numberPressed=g.length,m.pointer.justPressed=!0,m.pointer.x=e,m.pointer.y=t}function S(e,t){m.pointer.x=e,m.pointer.y=t}function b(e,t,n){g=g.filter((e=>e!==n)),0===g.length&&(m.pointer.justPressed=!1,m.pointer.pressed=!1),m.pointer.numberPressed=g.length,m.pointer.justReleased=!0,m.pointer.x=e,m.pointer.y=t}function P(e){g=g.filter((t=>t!==e)),m.pointer.numberPressed=g.length,0===g.length&&(m.pointer.justPressed=!1,m.pointer.pressed=!1)}function M(){m={keysDown:m.keysDown,keysJustPressed:{},pointer:{...m.pointer,justPressed:!1,justReleased:!1}}}const T=(e,t)=>{const n=e[t];if(!n)throw Error(`Image file "${t}" was not preloaded`);if("then"in n.data)throw Error(`Image file "${t}" did not finish loading before it was used`);return n.data},E=Math.PI/180,I=(e,t,n)=>{const{x:i,y:r,rotation:o,scaleX:a,scaleY:s,anchorX:l,anchorY:d,opacity:c}=t;0===i&&0===r||e.translate(i,-r),0!==o&&e.rotate(o*E),1===a&&1===s||e.scale(a,s),0===l&&0===d||e.translate(-l,d),1!==c&&(e.globalAlpha=n),function(e,t){if(!t)return 0;switch(t.type){case"lineMask":{const[[n,i],...r]=t.path;return e.beginPath(),e.moveTo(n,-i),r.forEach((([t,n])=>{e.lineTo(t,-n)})),e.clip(),0}case"circleMask":return e.beginPath(),e.arc(t.x,-t.y,Math.round(t.radius),0,2*Math.PI),e.clip(),0;case"rectangleMask":e.beginPath(),e.rect(t.x-t.width/2,-t.y-t.height/2,t.width,t.height),e.clip()}}(e,t.mask)},x=e=>({globalAlphaStack:[1],circle(t,n){e.beginPath(),e.arc(0,0,Math.round(t),0,2*Math.PI),e.fillStyle=n,e.fill(),e.closePath()},rectangle(t,n,i){e.fillStyle=i,e.fillRect(-t/2,-n/2,t,n),e.closePath()},line(t,n,i,r,o){if(t.length<2)return;const[[a,s],...l]=t;e.beginPath(),e.moveTo(a,-s),l.forEach((([t,n])=>{e.lineTo(t,-n)})),r&&(e.fillStyle=r,e.fill()),i&&(e.strokeStyle=i,e.lineWidth=n,e.lineCap=o,e.stroke())},text(t,n,i){const{size:r,weight:o="normal",style:a="normal",family:s}=t,l=`${a} ${o} ${r?`${r}px`:""} ${s?`${s}`:""}`;e.font=l,e.textBaseline=t.baseline||"middle",e.textAlign=t.align||"center",e.fillStyle=i,e.fillText(n,0,0)},image(t,n,i){e.drawImage(t,-n/2,-i/2,n,i)},spriteSheet(t,n,i,r,o,a){const s=t.width/n,l=t.height/i,d=r%n,c=Math.floor(r/n)%i;e.drawImage(t,d*s,c*l,s,l,-o/2,-a/2,o,a)}});function k(e,t,n,i){let r;r="portrait"in i?t>e?i.portrait:i.landscape:i;const{width:o,height:a,maxWidthMargin:s=0,maxHeightMargin:l=0}=r;if("game-coords"===n)return{width:o,height:a,widthMargin:0,heightMargin:0,deviceWidth:o,deviceHeight:a};const d=o/a;if(d>e/t){const n=e,i=n/d,r=i/a*l,s=Math.min(t,i+2*r);return{width:o,height:a,widthMargin:0,heightMargin:(s-i)/2*(a/i),deviceWidth:n,deviceHeight:s}}{const n=t,i=n*d,r=i/o*s,l=Math.min(e,i+2*r);return{width:o,height:a,widthMargin:(l-i)/2*(o/i),heightMargin:0,deviceWidth:l,deviceHeight:n}}}function L(){const e={};return{start:(t,n)=>{const i=window.setTimeout((()=>{delete e[r],t()}),n),r=String(i);return e[r]={timeoutId:i,callback:t,timeStartedMs:Date.now(),timeRemainingMs:n,isPaused:!1},r},pause:t=>{const n=e[t];if(!n||n.isPaused)return;const i=Date.now()-n.timeStartedMs;n.timeRemainingMs-=i,n.isPaused=!0,window.clearTimeout(n.timeoutId)},resume:t=>{const n=e[t];if(!n||!n.isPaused)return;n.timeStartedMs=Date.now(),n.isPaused=!1;const i=window.setTimeout((()=>{delete e[t],n.callback()}),n.timeRemainingMs);n.timeoutId=i},cancel:t=>{const n=e[t];n&&(window.clearTimeout(n.timeoutId),delete e[t])}}}function C(e,t){return n=>{if(!t[n])throw Error(`Audio file "${n}" was not preloaded`);const{data:i}=t[n];if("then"in i)throw Error(`Audio file "${n}" did not finish loading before it was used`);const{buffer:r,playState:o}=i;return{getPosition:()=>R(e,i.playState),play:a=>{let s,l=!1,d=!1,c=1;"number"==typeof a?s=a:a&&({fromPosition:s,loop:l=l,overwrite:d=d,playbackRate:c=c}=a);const p=e.createBufferSource();p.buffer=r,p.playbackRate.value=c;const h=e.createGain();p.connect(h),h.connect(e.destination);const u=null!=s?s:R(e,o);p.start(void 0,u),p.loop=l,p.onended=()=>{var e;if(!t[n])return;const{data:i}=t[n];"then"in i||!1!==(null===(e=i.playState)||void 0===e?void 0:e.isPaused)||delete i.playState};const m=o&&!o.isPaused;m&&!d||(o&&m&&(o.sample.onended=null,o.sample.stop()),i.playState={playTime:e.currentTime,sample:p,alreadyPlayedTime:u,isPaused:!1,gainNode:h})},pause:()=>{o&&!o.isPaused&&(o.sample.stop(),i.playState={...o,alreadyPlayedTime:R(e,o),isPaused:!0})},getStatus:()=>i.playState&&!1===i.playState.isPaused?"playing":"paused",getDuration:()=>r.duration,getVolume:()=>i.playState?i.playState.gainNode.gain.value:1,setVolume:e=>{const t=i.playState;t&&e>=0&&e<=1&&(t.gainNode.gain.value=e)}}}}function R(e,t){return t?t.isPaused?t.alreadyPlayedTime:(e.currentTime-t.playTime)*t.sample.playbackRate.value+t.alreadyPlayedTime:0}const _={family:"sans-serif",size:12};function z(e,t,n){const{dimensions:i="game-coords",canvas:r,nativeSpriteMap:o={},windowSize:a,statsBegin:p,statsEnd:h}=t||{},u=r||document.createElement("canvas");r||document.body.appendChild(u);const m=window.PointerEvent?"pointerdown":"touchstart",g=window.PointerEvent?"pointermove":"touchmove",E=window.PointerEvent?"pointerup":"touchend",R=window.PointerEvent?"pointercancel":"touchcancel",z=u.getContext("2d",{alpha:!1}),X=new(window.AudioContext||window.webkitAudioContext);let F=!0,Y=!0,$=0,A=!1,j=0,D=0;const O=()=>{document.hidden&&Y&&(j=$,X.suspend()),document.hidden||Y||(A=!0,setTimeout((()=>{X.suspend(),setTimeout((()=>{X.resume()}),75)}),75)),Y=!document.hidden};document.addEventListener("keydown",(e=>{F&&!e.repeat&&w(e)}),!1),document.addEventListener("keyup",(e=>{F&&v(e)}),!1),document.addEventListener("visibilitychange",O,!1),window.addEventListener("resize",q,!1);const H=()=>q({didScroll:!0});let W,N,G,U,B,J;window.addEventListener("scroll",H,!1),document.addEventListener("contextmenu",(e=>{e.preventDefault()}));const V={didResize:!1,scale:1,gameXToPlatformX:e=>e,gameYToPlatformY:e=>e};function q(t){const n=Boolean(t&&"cleanup"in t&&t.cleanup),r=Boolean(t&&"didScroll"in t&&t.didScroll);if(W&&(z.restore(),document.removeEventListener(m,N),document.removeEventListener(g,G),document.removeEventListener(E,U),document.removeEventListener(R,B),n))return;r&&W||(ie.size=k((null==a?void 0:a.width)||window.innerWidth,(null==a?void 0:a.height)||window.innerHeight,i,e.props.size)),u.width=ie.size.deviceWidth,u.height=ie.size.deviceHeight;const o=e.props.defaultFont||_,s=function(e,{width:t,height:n,widthMargin:i,heightMargin:r,deviceWidth:o,deviceHeight:a},s,l){e.save();const d=Math.min(o/t,a/n),c=t+2*i,p=n+2*r;e.translate(o/2,a/2),e.scale(d,d);const h=x(e);return{scale:d,render:{newFrame:()=>{e.clearRect(-o/2/d,-a/2/d,o/d,a/d),e.fillStyle="white",e.fillRect(-c/2,-p/2,c,p)},startRenderSprite:t=>{e.save();const n=t.opacity*h.globalAlphaStack[0];I(e,t,n),h.globalAlphaStack.unshift(n)},endRenderSprite:()=>{e.restore(),h.globalAlphaStack.shift()},renderTexture:t=>{e.save();const n=t.props.opacity*h.globalAlphaStack[0];I(e,t.props,n),function(e,t,n,i){switch(e.type){case"text":const r={...i,...e.props.font};return t.text(r,e.props.text,e.props.color),0;case"circle":return t.circle(e.props.radius,e.props.color),0;case"rectangle":return t.rectangle(e.props.width,e.props.height,e.props.color),0;case"line":return t.line(e.props.path,e.props.thickness,e.props.color,e.props.fillColor,e.props.lineCap),0;case"image":return t.image(T(n,e.props.fileName),e.props.width,e.props.height),0;case"spriteSheet":t.spriteSheet(T(n,e.props.fileName),e.props.columns,e.props.rows,e.props.index,e.props.width,e.props.height)}}(t,h,s,l),e.restore()}}}}(z,ie.size,Q,o);J=s.scale,ne.newFrame=s.render.newFrame,ne.startRenderSprite=s.render.startRenderSprite,ne.endRenderSprite=s.render.endRenderSprite,ne.renderTexture=s.render.renderTexture,V.gameXToPlatformX=(({canvasOffsetLeft:e,widthMargin:t,scale:n,width:i})=>r=>e+n*(r+i/2+t))({canvasOffsetLeft:u.offsetLeft,width:ie.size.width,widthMargin:ie.size.widthMargin,scale:J}),V.gameYToPlatformY=(({canvasOffsetTop:e,heightMargin:t,scale:n,height:i})=>r=>e-n*(r-i/2-t))({canvasOffsetTop:u.offsetTop,height:ie.size.height,heightMargin:ie.size.heightMargin,scale:J}),V.didResize=!0,V.scale=J;const l=(({canvasOffsetLeft:e,scrollX:t,widthMargin:n,scale:i,width:r})=>o=>(o.clientX-e+t)/i-n-r/2)({canvasOffsetLeft:u.offsetLeft,scrollX:window.scrollX,width:ie.size.width,widthMargin:ie.size.widthMargin,scale:J}),d=(({canvasOffsetTop:e,scrollY:t,heightMargin:n,scale:i,height:r})=>o=>-(o.clientY-e+t)/i+n+r/2)({canvasOffsetTop:u.offsetTop,scrollY:window.scrollY,height:ie.size.height,heightMargin:ie.size.heightMargin,scale:J}),c=(e,t)=>e>ie.size.width/2+ie.size.widthMargin||e<-ie.size.width/2-ie.size.widthMargin||t>ie.size.height/2+ie.size.heightMargin||t<-ie.size.height/2-ie.size.heightMargin;N=e=>{if("changedTouches"in e){F=!1;for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches[t],i=l({clientX:n.screenX}),r=d({clientY:n.screenY});c(i,r)||(F=!0,y(i,r,n.identifier))}return}const t=l(e),n=d(e);c(t,n)?F=!1:(F=!0,y(t,n,e.pointerId))},G=e=>{if("changedTouches"in e){for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches[t],i=l({clientX:n.screenX}),r=d({clientY:n.screenY});c(i,r)||S(i,r)}return}const t=l(e),n=d(e);c(t,n)||S(t,n)},U=e=>{if("changedTouches"in e){for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches[t],i=l({clientX:n.screenX}),r=d({clientY:n.screenY});c(i,r)?P(n.identifier):b(i,r,n.identifier)}return}const t=l(e),n=d(e);c(t,n)?P(e.pointerId):b(t,n,e.pointerId)},B=e=>{if("changedTouches"in e)for(let t=0;t<e.changedTouches.length;t++)P(e.changedTouches[t].identifier);else P(e.pointerId)},document.addEventListener(m,N,!1),document.addEventListener(g,G,!1),document.addEventListener(E,U,!1),document.addEventListener(R,B,!1),W=ie.size}const K={},Q={},Z=(e,t)=>()=>{throw Error(`Failed to load ${e} file "${t}"`)},ee=(null==n?void 0:n.fileFetch)||fetch,te={audioElements:K,imageElements:Q,loadAudioFile:e=>async function(e,t){const n=await t,i=await n.arrayBuffer();return await new Promise(((t,n)=>{e.decodeAudioData(i,t,n)}))}(X,ee(e)).then((e=>({buffer:e,volume:1}))).catch(Z("audio",e)),loadImageFile:e=>new Promise(((t,n)=>{const i=new Image;i.addEventListener("load",(()=>{t(i)})),i.addEventListener("error",n),i.src=e})).catch(Z("image",e)),cleanupAudioFile:e=>{const{data:t}=K[e];!("then"in t)&&t.playState&&(t.playState.sample.onended=null,t.playState.sample.disconnect(),t.playState.sample.buffer=null)},cleanupImageFile:()=>null},ne={newFrame:()=>null,startRenderSprite:()=>null,endRenderSprite:()=>null,renderTexture:()=>null},ie=function(e,t,n,i){return{isTouchScreen:!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)||window.matchMedia("(touch-enabled),(-webkit-touch-enabled),(-moz-touch-enabled),(-o-touch-enabled),(-ms-touch-enabled)").matches,log:console.log,random:Math.random,timer:L(),audio:C(e,n.audioElements),assetUtils:n,network:{get:(e,t)=>{fetch(e).then((e=>e.json())).then(t)},post:(e,t,n)=>{fetch(e,{method:"POST",body:JSON.stringify(t)}).then((e=>e.json())).then(n)},put:(e,t,n)=>{fetch(e,{method:"PUT",body:JSON.stringify(t)}).then((e=>e.json())).then(n)},delete:(e,t)=>{fetch(e,{method:"DELETE"}).then((e=>e.json())).then(t)}},storage:{getItem:async e=>localStorage.getItem(e),setItem:async(e,t)=>{null!==t?localStorage.setItem(e,t):localStorage.removeItem(e)}},alert:{ok:(e,t)=>{alert(e),null==t||t()},okCancel:(e,t)=>{t(confirm(e))}},clipboard:{copy:(e,t)=>{navigator.clipboard?navigator.clipboard.writeText(e).then((()=>{t()})).catch((e=>{t(e)})):t(new Error(window.isSecureContext?"Couldn't access clipboard":"Clipboard only available on HTTPS or localhost"))}},size:t,now:()=>new Date,...i}}(X,k((null==a?void 0:a.width)||window.innerWidth,(null==a?void 0:a.height)||window.innerHeight,i,e.props.size),te,(null==n?void 0:n.device)||{}),re={mutDevice:ie,getInputs:f,render:ne};q();let oe=!1;const ae=()=>{document.removeEventListener("keydown",ae,!1),document.removeEventListener(m,ae,!1),"suspended"===X.state&&X.resume(),X.onstatechange=()=>{"suspended"!==X.state||document.hidden||X.resume()}};document.addEventListener("keydown",ae,!1),document.addEventListener(m,ae,!1);const{runNextFrame:se}=function(e,t,n,i){const r=({x:e,y:t})=>({x:e,y:t}),{mutDevice:o,getInputs:a}=e,p=d(n,o,(()=>a(r)),0,n.props.id),h=n.props.size,u=c(o.size,h);let m=0,g=0;s(p,n.props,o,a,r,!0,u,0,n.props.id,t,e.render);const f={newFrame:()=>null,startRenderSprite:()=>null,endRenderSprite:()=>null,renderTexture:()=>null};return{runNextFrame(i,d){const u=i-m;m=i,g+=u;let w=Math.floor(g/l);for(;w>0;){g-=l,w--;const i=g/l,u=c(o.size,h),m=0===w?e.render:f;m.newFrame(),s(p,n.props,o,a,r,!1,u,i,n.props.id,t,m),d()}}}}(re,{nativeSpriteMap:o,nativeSpriteUtils:V},e);let le=null;return function e(){null==h||h(),window.requestAnimationFrame((function(t){oe||(null==p||p(),null===le&&(le=t-1/60),A&&(A=!1,D+=t-j),$=t,se(t-le-D,M),e())}))}(),{cleanup:function(){u.width=u.width,r||document.body.removeChild(u),oe=!0,document.removeEventListener("keydown",w,!1),document.removeEventListener("keyup",v,!1),document.removeEventListener("visibilitychange",O,!1),window.removeEventListener("resize",q,!1),window.removeEventListener("scroll",H,!1),q({cleanup:!0})},audioElements:K,imageElements:Q,audioContext:X}}function X({id:e,message:t}){return new Promise((n=>{new Promise((t=>{let n=window.__replayGlobalCallbacks__;n||(n={},window.__replayGlobalCallbacks__=n),n[e]=e=>{t(e)}})).then((t=>{window.__replayGlobalCallbacks__[e]=void 0,n(t)})),window.webkit.messageHandlers.jsCallback.postMessage(t)}))}function F(){z(game.Game(game.gameProps),game.options,{device:{storage:{getItem:async e=>{const t=await X({id:`__internalReplayStorageGetItem-${e}`,message:`__internalReplayStorageGetItem-${e}`});if("error"in t)throw Error(t.error);return t.value},setItem:async(e,t)=>{if(null===t){const t=await X({id:`__internalReplayStorageRemoveItem-${e}`,message:`__internalReplayStorageRemoveItem-${e}`});if("string"==typeof t)throw Error(t);return}const n=await X({id:`__internalReplayStorageSetItem-${e}`,message:`__internalReplayStorageSetItem-${e}_____end_of_key______${t}`});if("string"==typeof n)throw Error(n)}},clipboard:{copy(e,t){X({id:"__internalReplayClipboardCopy",message:`__internalReplayClipboardCopy${e}`}).then((()=>{t()}))}}}})}console.log=e=>{window.webkit.messageHandlers.consoleLog.postMessage(e)}}},t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}return n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(95)})();